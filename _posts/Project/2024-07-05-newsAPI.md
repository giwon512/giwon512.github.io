---
layout: single
title: íŒ¨ì…˜ í¬í„¸ ì›¹ì„œë¹„ìŠ¤ News API í˜¸ì¶œê³¼ì •
categories: Project
tag: [Frontend, Backend, Java, ìŠ¤í”„ë§ë¶€íŠ¸, ì„œë²„, ë°ì´í„°ë² ì´ìŠ¤]
toc: true
---


# ë‰´ìŠ¤ API í˜¸ì¶œ ê³¼ì •

ë‰´ìŠ¤ ë‚´ìš©ì„ ì‚¬ìš©ìë“¤ì—ê²Œ ë¿Œë ¤ì£¼ê¸° ìœ„í•´ í¬ë¡¤ë§ í•´ì˜¨ ë‰´ìŠ¤ ë°ì´í„°ë“¤ì„ ê´€ë¦¬ì í˜ì´ì§€ì—ì„œ ë‹¤ë£¨ëŠ” ë‚´ìš©ë¶€í„°, ê° í˜ì´ì§€ì— ìˆ˜ì •ëœ ë‰´ìŠ¤ ê°ì²´ë“¤ì´ ì¶œë ¥ë˜ëŠ” ê³¼ì •ê¹Œì§€ ê¸°ìˆ í•˜ê³ ì í•œë‹¤.

## âš ï¸ Trouble Shooting

ë¬¸ì œ ìƒí™© : ê´€ë¦¬ì í˜ì´ì§€ì—ì„œ ê°“ í¬ë¡¤ë§ í•´ì˜¨ ë‰´ìŠ¤ ê°ì²´ ìˆ˜ì • ë©”ë‰´, ë°°ë„ˆ ë‰´ìŠ¤ ì„ íƒ ë©”ë‰´, ì‚¬ìš©ì ì´ìš© í†µê³„ ë©”ë‰´ë¥¼ ë‹¤ë£¨ê³ ì í–ˆê³ , ê° í˜ì´ì§€ë¥¼ nested routingì„ í†µí•´ ì ‘ê·¼í•˜ê³ ì í–ˆë‹¤. Link ì»´í¬ë„ŒíŠ¸ë¥¼ í†µí•´ì„œëŠ” ì˜ ì´ë™í–ˆì§€ë§Œ, ê²½ë¡œë¥¼ ì…ë ¥í•˜ë©´ ë¡œê·¸ì•„ì›ƒë˜ëŠ” í˜„ìƒì´ ë°œìƒí–ˆë‹¤. ì‹œì‘ë¶€í„° ë‚œê´€ì— ë¶€ë”ªí˜€ ë¬¸ì œë¥¼ ì°¾ì•„ë‚˜ì„œê²Œ ë˜ì—ˆë‹¤.

í•´ê²°

Link ì»´í¬ë„ŒíŠ¸ë¥¼ ê±°ì¹˜ì§€ ì•Šê³  ì£¼ì†Œ ì°½ì— ì§ì ‘ ê²½ë¡œë¥¼ ì…ë ¥í•˜ë©´ ìƒˆë¡œê³ ì¹¨ì´ ì¼ì–´ë‚˜ê²Œ ë˜ëŠ”ë°, **ì´ë•Œ í˜ì´ì§€ì˜ ìƒíƒœê°€ ë‹¤ ì—…ë°ì´íŠ¸ ë˜ê¸° ì „ì— ë Œë”ë§ì´ ë¨¼ì € ë˜ì–´ë²„ë¦¬ëŠ” ë¬¸ì œê°€ ë°œìƒí–ˆë‹¤.** ê´€ë¦¬ì í˜ì´ì§€ì˜ ê²½ìš° ë¨¼ì € ë¡œê·¸ì¸ ìƒíƒœì¸ì§€, ê´€ë¦¬ìì¸ì§€ í™•ì¸í•˜ëŠ” ê³¼ì •ì„ ê±°ì¹œ í›„ isLoggedIn, isAdminì„ trueë¡œ ë°”ê¿”ì£¼ëŠ”ë° ì´ ìƒíƒœë¥¼ ì²´í¬í•˜ê¸° ì „ ë Œë”ë§ì´ ë˜ë©´ì„œ ë¡œê·¸ì¸ì´ ë˜ì–´ ìˆì§€ ì•Šë‹¤ê³  íŒë‹¨ë˜ëŠ” ë¬¸ì œê°€ ë°œìƒí–ˆë‹¤. ê·¸ë˜ì„œ ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™ì„ í•˜ëŠ”ë°, ë’¤ëŠ¦ê²Œ ì—…ë°ì´íŠ¸ ë˜ì–´ ë¡œê·¸ì¸ í˜ì´ì§€ì—ì„œëŠ” ë¡œê·¸ì¸ì´ ë˜ì–´ ìˆë‹¤ê³  íŒë‹¨ì„ í•˜ë‹ˆ ê¸°ë³¸ í˜ì´ì§€ë¡œ ë¦¬ë””ë ‰íŠ¸ ë˜ëŠ” ê²ƒì´ì—ˆë‹¤. í•˜í•„ ê¸°ë³¸ í˜ì´ì§€ë¡œ ìƒˆë¡œê³ ì¹¨ì´ ë˜ë‹ˆ ë¬¸ì œë¥¼ ì°¾ëŠ” ë° ë” ì˜¤ë˜ ê±¸ë¦° ê²ƒ ê°™ë‹¤.

# ğŸ“– ë‰´ìŠ¤ ë°ì´í„° ë° ì´ë¯¸ì§€ í¬ë¡¤ë§í•˜ê¸°

í¬ë¡¤ë§í•˜ê¸°ê¹Œì§€ì˜ ê³¼ì •ì€ ë¸”ë¡œê·¸ì— ë”°ë¡œ ì •ë¦¬í•´ë‘ì—ˆë‹¤.

1. ì›¹í¬ë¡¤ë§ì„ ìœ„í•œ ê¸°ë³¸ ê°œë… ì •ë¦¬
    
    [https://giwon512.github.io/python/WebCrawling/](https://giwon512.github.io/python/WebCrawling/)
    
2. ìë°”ìŠ¤í¬ë¦½íŠ¸ í™˜ê²½ì—ì„œ í¬ë¡¤ë§ íŒŒì´ì¬ ì½”ë“œ ì‹¤í–‰í•˜ê¸°
    
    [https://giwon512.github.io/python/NodePython/](https://giwon512.github.io/python/NodePython/)
    
3. í¬ë¡¤ë§í•œ ì´ë¯¸ì§€ íŒŒì¼ base64í˜•ì‹ìœ¼ë¡œ dbì— ì €ì¥í•˜ê¸°
    
    [https://giwon512.github.io/python/ImageCrawling/](https://giwon512.github.io/python/ImageCrawling/)
    

**êµ¬í˜„í•´ì•¼ í•  ê³¼ì •**

```
1. [node connectPython.js] ëª…ë ¹ì–´ë¥¼ í†µí•´ scraping.py ì‹¤í–‰
- test_newsì— ë‰´ìŠ¤ insert
- ì§ì „ì— ìƒˆë¡œ ì‚½ì…ëœ ë‰´ìŠ¤ ID ê°’ select
- test_imageì— base64ë¡œ ì¸ì½”ë”©ëœ jpg íŒŒì¼ ë‚´ìš© + í•´ë‹¹í•˜ëŠ” ë‰´ìŠ¤ ID ê°’ ì‚½ì…
2. api ì‹¤í–‰ì„ í†µí•´ dbì—ì„œ ë‰´ìŠ¤ ê°ì²´ì™€ ê°ì²´ì˜ newsIDì— í•´ë‹¹í•˜ëŠ” ì´ë¯¸ì§€ ê°ì²´ ê°€ì ¸ì˜¤ê¸°
3. edit ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ quill ì—ë””í„° img text box ì•ˆì— ì´ë¯¸ì§€ ê°’ ì‚½ì…
4. ì¹´í…Œì½”ë¦¬ ì§€ì • í›„ ì €ì¥ ì‹œ ë‰´ìŠ¤ í˜ì´ì§€ì— ëŒ€í‘œì´ë¯¸ì§€ ë³´ì´ê¸°
```

# ğŸ“– ë‰´ìŠ¤ ë°ì´í„° ìˆ˜ì • ë° ê²Œì‹œí•˜ê¸°

ì—¬ê¸°ì„œ í•„ìš”í•œ ê¸°ëŠ¥ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

1. í¬ë¡¤ë§í•´ì˜¨ ë‰´ìŠ¤ ëª©ë¡ ì¶œë ¥
2. ìˆ˜ì • ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ì›¹ì—ë””í„°ì— ë‚´ìš© ì¶œë ¥
3. ì›¹ì—ë””í„°ì— ìˆ˜ì •í•˜ê³  ì¹´í…Œê³ ë¦¬ ì§€ì •í•´ì£¼ê¸°
4. ì™„ë£Œ ì‹œ ì¹´í…Œê³ ë¦¬ì— ë§ê²Œ ìˆ˜ì •ëœ ë‚´ìš© ê·¸ëŒ€ë¡œ ê²Œì‹œ

ë‹¨ìˆœí•œ Read, Update, Deleteë¥¼ í•˜ê¸° ë•Œë¬¸ì— ë°±ì—”ë“œ ë¡œì§ì€ êµ³ì´ ì„¤ëª…í•˜ì§€ ì•ŠëŠ”ë‹¤.

### ğŸ“š GET /raw-news?pageNum={}&pageSize={}

/raw-news?pageNum=3&pageSize=10ì„ í•˜ê²Œ ë˜ë©´ í•œ í˜ì´ì§€ì— ì¶œë ¥ë˜ëŠ” ë‰´ìŠ¤ì˜ ê°œìˆ˜ê°€ 10ê°œì¸ë°, 3í˜ì´ì§€ì˜ ë‰´ìŠ¤ ë°ì´í„°ë“¤ì„ ê°€ì ¸ì˜¤ê² ë‹¤ëŠ” ì˜ë¯¸ì´ë‹¤.

ğŸ“„ **allNewsList**

fetchAllNews() í•¨ìˆ˜ë¡œ ê°’ì´ ì •í•´ì§€ëŠ” ìƒíƒœ ê°’ìœ¼ë¡œ, ìµœì‹  1000ê°œì˜ ë‰´ìŠ¤ ë°ì´í„°ë¥¼ ê°€ì§€ê³  ìˆë‹¤.

ğŸ“„ **searchTerm**

ê²€ìƒ‰ ì°½ì— ì íŒ ë‚´ìš©ì´ ê¸°ë¡ë˜ëŠ” ìƒíƒœ ê°’ì´ë‹¤.

ğŸ“„ **filteredNewsList**

`handleSearch()` í•¨ìˆ˜ë¥¼ í†µí•´ `allNewsList`ì— ìˆëŠ” ë‰´ìŠ¤ ë°ì´í„°ë“¤ ì¤‘ íƒ€ì´í‹€ì´ë‚˜ ì¹´í…Œê³ ë¦¬ì˜ ë‚´ìš©ì— `searchTerm` ìƒíƒœ ê°’ì´ í¬í•¨ë˜ëŠ” ë‰´ìŠ¤ ê°ì²´ë“¤ì„ ì €ì¥í•˜ê³  ìˆëŠ” ìƒíƒœ ê°’ì´ë‹¤. í˜ì´ì§• ì²˜ë¦¬ê°€ ë˜ì–´ìˆì–´ í•œ ë²ˆì— 10ê°œê¹Œì§€ì˜ ë‰´ìŠ¤ ë°ì´í„°ë“¤ì´ ë“¤ì–´ê°€ìˆë‹¤.

### ğŸ“š DELETE /raw-news/{newsId}

ë‹¨ìˆœíˆ newsIdì— í•´ë‹¹í•˜ëŠ” ë‰´ìŠ¤ ë°ì´í„°ë¥¼ dbì—ì„œ ì œê±°í•˜ëŠ” ìš”ì²­ì„ ìˆ˜í–‰í•œë‹¤. 

### ğŸ“š PUT /raw-news/{selectedNews.newsId}

1. edit ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ `selectedNews` stateì˜ ê°’ì´ ë³€ê²½ë˜ê³ , `content` stateì— í•´ë‹¹ ë‰´ìŠ¤ì˜ ë³¸ë¬¸ ë‚´ìš©ì´ ì €ì¥ëœë‹¤. ê·¸ í›„, ReactQuill ì—ë””í„° ì»´í¬ë„ŒíŠ¸ê°€ ë°‘ì— ë Œë”ë§ì´ ë˜ê³ , `content` ê°’ì´ ì—ë””í„°ì— ì¶œë ¥ì´ ëœë‹¤.
2. `handleCategoryChange()` í•¨ìˆ˜ë¥¼ í†µí•´ ì¹´í…Œê³ ë¦¬ë¥¼ ì§€ì •í•´ì¤„ ìˆ˜ ìˆê³ , ì´ë¥¼ í†µí•´ ì¶”í›„ì— ì¹´í…Œê³ ë¦¬ ë‰´ìŠ¤ë¥¼ ì¶œë ¥í•  ìˆ˜ ìˆê²Œ ëœë‹¤.
3. ê·¸ í›„ save ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ `handleSaveNews()` í•¨ìˆ˜ê°€ í˜¸ì¶œì´ ë˜ëŠ”ë°, ì—¬ê¸°ì„œ `ql-editor` í´ë˜ìŠ¤ëŠ” ì •í™•íˆ ë³¸ë¬¸ ë‚´ìš©ì´ ë‹´ê¸´ ì—ë””í„°ì— í•´ë‹¹í•˜ëŠ” div íƒœê·¸ë¥¼ ê°€ë¦¬í‚¤ê³  ìˆë‹¤.
4. put ë°©ì‹ìœ¼ë¡œ apië¥¼ í˜¸ì¶œí•´ì„œ ë°”ë€ ì»¨í…ì¸ ì˜ ë‚´ìš©ì„ ê°€ì§€ê³  ì—…ë°ì´íŠ¸ ì¿¼ë¦¬ë¥¼ ì‹¤í–‰í•œ í›„ì—, allNewsListë¥¼ ì´ˆê¸°í™”í•´ì„œ ìµœì‹  ë°˜ì˜ëœ ë‚´ìš©ì„ ë‹¤ì‹œ ì €ì¥í•´ë‘ê²Œ ëœë‹¤.

# ğŸ“– ë©”ì¸ í˜ì´ì§€ì— ì¹´í…Œê³ ë¦¬ ë³„ë¡œ ë‰´ìŠ¤ 3ê°œì”© ê²Œì‹œí•˜ê¸°

### ğŸ“š GET /top3?category=${category}

ë§ ê·¸ëŒ€ë¡œ íŠ¹ì • ì¹´í…Œê³ ë¦¬ì—ì„œ ê°€ì¥ ìµœì‹  ë‰´ìŠ¤ 3ê°œë¥¼ ê°€ì ¸ì˜¤ëŠ” ì—­í• ì„ ìˆ˜í–‰í•œë‹¤.

### ğŸ“š GET /top3/${newsId}

í•´ë‹¹ ë‰´ìŠ¤ì˜ ëŒ€í‘œ ì´ë¯¸ì§€ ê°’ì„ ê°€ì ¸ì˜¨ë‹¤. ì´ë•Œ ê°€ì ¸ì˜¤ëŠ” ê°’ì€, base64ë¡œ ì¸ì½”ë”©ëœ ê°’ì´ë‹¤.

```jsx
useEffect(() => {
    const getImages = async () => {
        let imgContent = []
        for (const news of newsList) {
            await api.get(`/top3/${news.newsId}`)
            .then(response => imgContent.push(response.data))
            .catch(error => console.error('Error fetching news images', error));
        }
        setImgList(imgContent);
        setIsLoading(false);
    }

    getImages();
}, [newsList]);

if(isLoading) {
    return <h2>Loading...</h2>
}
```

useEffect() í•¨ìˆ˜ë¥¼ í†µí•´ ë©”ì¸ í˜ì´ì§€ë¥¼ ì‹¤í–‰í•˜ë©´ `newsList`ì™€ `imgList`ì— ê°’ì„ ì €ì¥í•˜ê³ , ë Œë”ë§í•´ì£¼ëŠ” ì‘ì—…ì„ ìˆ˜í–‰í•œë‹¤.

ğŸ“„ **newsList**

propsë¡œ ë„˜ì–´ì˜¨ `category`ê°’ì— í•´ë‹¹í•˜ëŠ” ì¹´í…Œê³ ë¦¬ì˜ ìµœì‹  ë‰´ìŠ¤ 3ê°œê°€ ì €ì¥ë˜ì–´ ìˆë‹¤.

ğŸ“„ **imgList**

`newsList`ë¥¼ ìˆœíšŒí•˜ë©°, ìˆœì„œëŒ€ë¡œ ì´ë¯¸ì§€ ë°ì´í„°ë¥¼ ê°€ì ¸ì™€ ì €ì¥í•œë‹¤.

# ğŸ“– ìµœê·¼ ê²Œì‹œê¸€ í‘œì‹œí•˜ê¸°

í™ˆí˜ì´ì§€ í•˜ë‹¨ì—ëŠ” ìµœì‹  ìˆœìœ¼ë¡œ 9ê°œì˜ ë‰´ìŠ¤ê°€ í‘œì‹œëœë‹¤.

### ğŸ“š GET /processed-news?pageNum=1&pageSize=9

ê°€ê³µëœ ë‰´ìŠ¤ë¥¼ ìµœì‹  ìˆœìœ¼ë¡œ ê°€ì ¸ì˜¤ëŠ” apiì¸ë° ì²« 9ê°œë§Œ ê°€ì ¸ì˜¤ë„ë¡ íŒŒë¼ë¯¸í„° ê°’ì„ ì„¤ì •í•´ì£¼ì—ˆë‹¤. `GET /top3?category=${category}` apiì™€ëŠ” ë‹¤ë¥´ê²Œ ë°±ì—”ë“œì—ì„œ ì´ë¯¸ì§€ê¹Œì§€ í•œ ë²ˆì— ê°€ì ¸ì˜¤ë„ë¡ ì²˜ë¦¬ë¥¼ í•˜ì˜€ë‹¤.

```java
public Map<String, Object> getAllProcessedNews(int pageNum, int pageSize) {
    int offset = (pageNum - 1) * pageSize;
    List<ProcessedNews> processedNewsList = newsMapper.findProcessedNewsByPagination(offset, pageSize);
    long total = newsMapper.countProcessedNewsAll();
    Map<Long, String> imgContent = new HashMap<>(); 
    for(ProcessedNews news : processedNewsList) {
    	String img = newsMapper.getImageByNewsId(news.getNewsId());
    	imgContent.put(news.getNewsId(), img);
    }

    Map<String, Object> response = new HashMap<>();
    response.put("content", processedNewsList);
    response.put("currentPage", pageNum);
    response.put("totalItems", total);
    response.put("totalPages", (int) Math.ceil((double) total / pageSize));
    response.put("imgContent", imgContent);
    return response;
}
```

hashMapì— ë‰´ìŠ¤ ì•„ì´ë””ë¥¼ í‚¤ë¡œ ê°–ëŠ” base64Url ì´ë¯¸ì§€ë¥¼ ë„£ì–´ ê°’ì„ ë¦¬í„´í•œë‹¤. ì € í˜•ì‹ìœ¼ë¡œ ë„£ê²Œ ë˜ë©´ í”„ë¡ íŠ¸ì—”ë“œì—ì„œ ì´ë¯¸ì§€ ê°’ì€ ë‹¤ìŒê³¼ ê°™ì´ ë„£ì„ ìˆ˜ ìˆë‹¤.

```jsx
<img src={"data:image/jpg;base64,"+ imgList[article.newsId]} alt={article.title} className="article-image" />
```

ë‚˜ë¨¸ì§€ ë‰´ìŠ¤ ì¶œë ¥ì„ ìœ„í•œ apië“¤ë„ ë‹¤ ë¹„ìŠ·í•˜ê²Œ ë™ì‘í•˜ê¸° ë•Œë¬¸ì—, ë‹¤ë¥¸ apiëŠ” ë” ì´ìƒ ë‹¤ë£¨ì§€ ì•ŠëŠ”ë‹¤.