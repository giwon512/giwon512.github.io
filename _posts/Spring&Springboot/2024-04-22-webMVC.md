---
layout: single
title: ìŠ¤í”„ë§ DI WebMVC êµ¬í˜„ ë°©ì‹
categories: ['Spring & Spring boot']
tag: [Backend, Java, ìë°”, ì„œë²„, ì„œë¸”ë¦¿, ìŠ¤í”„ë§]
toc: true
---


# ğŸ“”Controllerë¥¼ ìœ„í•œ ì£¼ìš” í´ë˜ìŠ¤

### org.springframework.web.servlet.mvc.Controller

- ìŠ¤í”„ë§ì—ì„  ë” ì´ìƒ ì„œë¸”ë¦¿ì„ ìƒì† ë°›ì§€ ì•Šê³ , ì»¨íŠ¸ë¡¤ëŸ¬ ì¸í„°í˜ì´ìŠ¤ë¥¼ í™œìš©í•˜ì—¬ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ë§Œë“ ë‹¤.
- Controller ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•˜ëŠ” AbstractController í´ë˜ìŠ¤ë¥¼ í™œìš©í•˜ì—¬ ë” ë‹¤ì–‘í•œ ê¸°ëŠ¥ì„ í™œìš©í•  ìˆ˜ ìˆë‹¤.

### org.springframework.web.servlet.DispatcherServlet

- í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ìœ„í•œ í´ë˜ìŠ¤ì´ë‹¤.
- web.xmlì—ì„œ ê°ì²´ë¥¼ ìƒì„±í•´ì¤€ë‹¤.
    
    ```xml
    <servlet>
    	<servlet-name>app1</servlet-name>
    	<servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
    </servlet>
    
    <servlet-mapping>
    	<servlet-name>app1</servlet-name>
    	<url-pattern>*.action</url-pattern>
    </servlet-mapping>
    ```
    
    .actionìœ¼ë¡œ ê²½ë¡œë¥¼ ì§€ì •í•´ë‘ë©´ ë¬´ì¡°ê±´ í”„ë¡ íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ í˜¸ì¶œí•˜ê²Œ í–ˆë‹¤.
    

- DispatcherServlet í´ë˜ìŠ¤ì˜ ì½”ë“œë¥¼ ì›í•˜ëŠ” ëŒ€ë¡œ ì¡°ì •í•  ìˆ˜ ìˆëŠ” ì„¤ì • íŒŒì¼ì´ ì œê³µëœë‹¤.
    - ì„¤ì • íŒŒì¼ì€ ê°€ê¸‰ì ì´ë©´ WEB-INFì•ˆì— web.xmlê³¼ ê°™ì€ ìœ„ì¹˜ì— ë§Œë“¤ì–´ì ¸ì•¼ í•œë‹¤.
    - ì„¤ì • íŒŒì¼ì˜ ì´ë¦„ì€ {ê°ì²´ ì´ë¦„}-servlet.xmlë¡œ ì§€ì–´ì£¼ì–´ì•¼ í•œë‹¤. ìœ„ì™€ ê°™ì´ ê°ì²´ë¥¼ ë§¤í•‘í•´ë†“ì€ ê²½ìš°, ì´ë¦„ì€ app1-servlet.xmlì´ ë  ê²ƒì´ë‹¤.
- `<url-pattern>/</url-pattern>` ì„ ì…ë ¥í•˜ë©´ í˜ì´ì§€ê°€ ì‹œì‘í•  ë•Œë¶€í„° ë°”ë¡œ DispatcherServlet í´ë˜ìŠ¤ë¥¼ í˜¸ì¶œí•  ìˆ˜ ìˆë‹¤.
    
    
    # ğŸ“” ì»¨íŠ¸ë¡¤ëŸ¬ ìƒì„±í•˜ê¸°
    
    ## ğŸ“ xml íŒŒì¼ë¡œ ì»¨íŠ¸ë¡¤ëŸ¬ ì„¤ì •í•˜ê¸°
    
    ğŸ“„ **app1-servlet.xml**
    
    ```xml
    <?xml version="1.0" encoding="UTF-8"?>
    <beans xmlns="http://www.springframework.org/schema/beans"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xmlns:context="http://www.springframework.org/schema/context"
        xsi:schemaLocation="http://www.springframework.org/schema/beans
            https://www.springframework.org/schema/beans/spring-beans.xsd
            http://www.springframework.org/schema/context
            https://www.springframework.org/schema/context/spring-context.xsd">
        
        <bean name="/spring1.action" class="webproject1.controller.SpringController"></bean>
    </beans>
    ```
    
    `name` ì†ì„±ì„ í†µí•´ ìš”ì²­ ì´ë¦„ì„ ì§€ì •í•´ì¤„ ìˆ˜ ìˆë‹¤. (ì„œë¸”ë¦¿ ë§¤í•‘ì˜ `url-pattern`íƒœê·¸ì™€ ë™ì¼)
    

## ğŸ“ ì»¨íŠ¸ë¡¤ëŸ¬ ë™ì‘ ê³¼ì •

### SpringController.java

```java
package webproject1.controller;

public class SpringController extends AbstractController{
	@Override
	protected ModelAndView handleRequestInternal(HttpServletRequest request, HttpServletResponse response)
			throws Exception {
		System.out.println("ì»¨íŠ¸ë¡¤ëŸ¬ í˜¸ì¶œë¨");
		return new ModelAndView("/WEB-INF/view/spring_result.jsp");
	}
}
```

### index.jsp

```java
<%@ page contentType="text/html; charset=UTF-8"%>
<html>
<body>
	<h2>Hello World!</h2>
	<a href="/webproject1/hello">ì§ì ‘ MVC ì²˜ë¦¬</a>
	<br><br>
	
	<a href="/webproject1/spring1.action">ìŠ¤í”„ë§ MVC ìš”ì²­ ì²˜ë¦¬</a>
</body>
</html>
```

1. spring.action ê²½ë¡œê°€ í˜¸ì¶œë¨
2. web.xmlì—ì„œ DispatcherServlet í´ë˜ìŠ¤ ê°ì²´ê°€ ìƒì„±ë˜ê³ , ìë™ìœ¼ë¡œ ì„¤ì • íŒŒì¼ì¸ app1-servlet.xml íŒŒì¼ë¡œ ì´ë™
3. name ì†ì„±ì´ /spring1.actionì¸ ë¹ˆ ê°ì²´ë¥¼ ì°¾ì•„ì„œ ìƒì„±í•œë‹¤.
4. ì´ ê²½ìš°, AbstactController í´ë˜ìŠ¤ë¥¼ ìƒì†ë°›ëŠ” springController ê°ì²´ê°€ ìƒì„±ë˜ê³ , ìë™ìœ¼ë¡œ ì˜¤ë²„ë¼ì´ë”©í•œ ë©”ì„œë“œê°€ í˜¸ì¶œëœë‹¤.
5. ë¦¬í„´ ê°’ì— ëª…ì‹œëœ ê²½ë¡œì˜ í˜ì´ì§€ê°€ ë³´ì¸ë‹¤.

## ğŸ“ ì–´ë…¸í…Œì´ì…˜ì„ í†µí•´ ì»¨íŠ¸ë¡¤ëŸ¬ ì„¤ì •í•˜ê¸°

ê·¸ëƒ¥ @Component ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•˜ë©´ ì¼ë°˜ ë¹ˆ ê°ì²´ê°€ ìƒì„±ì´ ë˜ëŠ”ë°, ì»¨íŠ¸ë¡¤ëŸ¬ í´ë˜ìŠ¤ë¥¼ ìƒì†ë°›ëŠ” ê°ì²´ë¥¼ ë§Œë“¤ê¸° ìœ„í•´ì„œëŠ” @Controller ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•˜ë©´ ëœë‹¤. ì´ ê²½ìš°, ì»¨íŠ¸ë¡¤ëŸ¬ í´ë˜ìŠ¤ë¥¼ ë”°ë¡œ ìƒì† ë°›ì„ í•„ìš”ë„ ì—†ë‹¤.

### SecondController.java

```java
@Controller
public class SecondController {

	@RequestMapping("/first")
	protected ModelAndView firstPage() {
		return new ModelAndView("/WEB-INF/view/first.jsp");
	}
	
	@RequestMapping("/second")
	protected ModelAndView secondPage(HttpServletRequest req) {
		String p1 = req.getParameter("p1");
		String p2 = req.getParameter("p2");
		ModelAndView mv = new ModelAndView("/WEB-INF/view/second.jsp");
		mv.addObject("param1", p1); //request.setAttribute("param1", p1);
		mv.addObject("param2", p2);
		return mv;
	}
	
	//@RequestMapping(value="/third", method=RequestMethod.POST)
	@PostMapping("/third")
	protected ModelAndView thirdPage(String name, int age, double point) {
		System.out.println(name + ", " + age + ", " + point);
		return new ModelAndView("/WEB-INF/view/third.jsp");
	}

}
```

@RequestMapping ì–´ë…¸í…Œì´ì…˜ì„ í†µí•´ í•´ë‹¹ ìš”ì²­ì´ ì™”ì„ ë•Œ, ìë™ìœ¼ë¡œ ë©”ì„œë“œë¥¼ ì‹¤í–‰í•˜ë„ë¡ ì§€ì •í•´ì¤„ ìˆ˜ ìˆë‹¤. ì´ë¥¼ í†µí•´ì„œ ì´ì œ ì„œë¸”ë¦¿ì„ í´ë˜ìŠ¤ê°€ ì•„ë‹Œ ë©”ì„œë“œ ë‹¨ìœ„ë¡œ ì§€ì •í•´ì¤„ ìˆ˜ ìˆë‹¤.

request ê°ì²´ë¡œ ê°’ì„ ì²˜ë¦¬í•˜ëŠ” ê²Œ ë²ˆê±°ë¡œìš¸ ìˆ˜ ìˆëŠ”ë°, ì•„ì˜ˆ ë§¤ê°œë³€ìˆ˜ë¡œ ê°’ì„ ë°›ì•„ì™€ë„ ëœë‹¤. ì—¬ê¸°ì—ëŠ” ì–´ë…¸í…Œì´ì…˜ì´ ìƒëµë˜ì—ˆëŠ”ë°, ì›ë˜ í˜•íƒœëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.

```java
@PostMapping("/third")
protected ModelAndView thirdPage(@RequestParam("name") String ireum, 
								 @RequestParam int age, 
								 @RequestParam double point) {
	System.out.println(name + ", " + age + ", " + point);
	return new ModelAndView("/WEB-INF/view/third.jsp");
}
```

ë”°ë¡œ ì§€ì •í•´ì£¼ì§€ ì•Šìœ¼ë©´ ë§¤ê°œë³€ìˆ˜ ëª…ê³¼ ë°›ì•„ì˜¤ëŠ” íŒŒë¼ë¯¸í„° ëª…ì„ ë˜‘ê°™ì´ ì¼ì¹˜ì‹œì¼œì•¼ í•˜ì§€ë§Œ, ì–´ë…¸í…Œì´ì…˜ì„ í†µí•´ì„œ ë³€ìˆ˜ ëª…ì„ ë°”ê¿”ì¤„ ìˆ˜ ìˆë‹¤.

### second.jsp

```html
<%@ page contentType="text/html; charset=UTF-8" isELIgnored="false"%>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
</head>
<body>
	<h1>ì—¬ê¸°ëŠ” second.jsp ì…ë‹ˆë‹¤.</h1>
	param1 : <%= request.getAttribute("param1") %><br>
	param2 : ${param2}<br>
</body>
</html>
```

maven ë²„ì „ì´ ì˜¤ë˜ëœ ê²½ìš° isELIgnored ì†ì„±ì˜ ë””í´íŠ¸ ê°’ì´ trueë¡œ ë˜ì–´ìˆê¸° ë•Œë¬¸ì— falseë¡œ ë‹¤ì‹œ ì§€ì •ì„ í•´ì£¼ë©´ ì •ìƒì ìœ¼ë¡œ ì‘ë™í•œë‹¤.

## ğŸ“ ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ê°„ë‹¨í•˜ê²Œ ê°’ ë„˜ê²¨ì£¼ê¸°

- **Model addAttribute()**
- **ModelAndView addObject()**
- **@RequestParam**
- **@ModelAttribute**

### SecondController.java

```java
@Controller
public class SecondController {

	...
	@RequestMapping("/fourth")
	protected ModelAndView fourthPage(String name, int age, double point, Model model) {
		User user = new User();
		user.setName(name);
		user.setAge(age);
		user.setPoint(point);
		
		ModelAndView mv = new ModelAndView("/WEB-INF/view/fourth.jsp");
		model.addAttribute("user", user); //mv.addObject(user);
		
		return mv;
	}
}
```

ğŸ“ **Model addAttribute(String attributeName, @Nullable Object attributeValue)**

í•´ë‹¹ í•¨ìˆ˜ë¥¼ ì´ìš©í•´ ëª¨ë¸ ê°ì²´ ë³€ìˆ˜ì— ë„˜ê²¨ì£¼ê³ ì í•˜ëŠ” ê°ì²´ ê°’ì„ ë„˜ê²¨ì£¼ê¸°ë§Œ í•´ë„ í•´ë‹¹ ê°’ì„ ëª©ì ì§€ í˜ì´ì§€ì—ì„œ í™œìš©í•  ìˆ˜ ìˆë‹¤. 

ğŸ“ **fourth.jsp**

```html
<%@ page contentType="text/html; charset=UTF-8" isELIgnored="false" %>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
</head>
<body>
	<h1>ì—¬ê¸°ëŠ” fourth.jsp ì…ë‹ˆë‹¤.</h1>
	<ul>
		<li>${user.name}</li>
		<li>${user.age}</li>
		<li>${user.point}</li>
	</ul>
</body>
</html>
```

ğŸ“ @**ModelAttribute**

```java
@GetMapping("/fourth")
	public ModelAndView fourthPage(@ModelAttribute User user, @RequestParam String chk) {
	ModelAndView mv = new ModelAndView("/WEB-INF/view/fourth.jsp");
	mv.addObject("user", user);
	mv.addObject("chk", chk);
	
	return mv;
}
```

ë„˜ì–´ì˜¤ëŠ” ê°’ë“¤ì´ user Dto í´ë˜ìŠ¤ì˜ í”„ë¡œí¼í‹°ë“¤ê³¼ ë§ì•„ë–¨ì–´ì§€ë©´ í•´ë‹¹ ì–´ë…¸í…Œì´ì…˜ì„ í†µí•´ ìë™ìœ¼ë¡œ ê°’ì„ ë°›ì•„ì˜¬ ìˆ˜ ìˆë‹¤. ì´ ì–´ë…¸í…Œì´ì…˜ì€ ìƒëµì´ ê°€ëŠ¥í•˜ë‹¤. ë„˜ì–´ì˜¤ëŠ” ê°’ë“¤ê³¼ Dto í´ë˜ìŠ¤ì˜ í”„ë¡œí¼í‹°ë“¤ì´ ë§ì•„ë–¨ì–´ì§€ì§€ ì•ŠëŠ”ë‹¤ë©´, ê·¸ íŒŒë¼ë¯¸í„°ë“¤ì€ ê·¸ëƒ¥ @RequestParamì„ í†µí•´ ë°›ì•„ì™€ì£¼ë©´ ëœë‹¤.

**ğŸ“ ë§¤ê°œë³€ìˆ˜ë¡œ ModelAndViewê°’ ë°›ì•„ì˜¤ê¸°**

```java
@GetMapping("/fifth")
	public ModelAndView fifthPage(ModelAndView mv) {
		List list = new ArrayList();
		list.add("ê¹€ì¹˜ì°Œê°œ");
		list.add("ì‚¼ê²¹ì‚´");
		list.add("ì¹˜í‚¨");
		list.add("êµ­ë°¥");
		mv.setViewName("/WEB-INF/view/fifth.jsp");
		mv.addObject("foods", list);
		return mv;
	}
```

ì´ëŸ° ì‹ìœ¼ë¡œ ë§¤ê°œë³€ìˆ˜ì—ì„œ ModelAndView ê°ì²´ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ë„ ìˆë‹¤. Modelê³¼ ModelAndView í´ë˜ìŠ¤ë¥¼ ë§¤ê°œë³€ìˆ˜ë¡œ ì •í•´ì£¼ëŠ” ëª¨ìŠµì„ ë³¼ ìˆ˜ ìˆëŠ”ë°, ì–´ë””ì„ ê°€ ê°ì²´ë¥¼ ìƒì„±í•´ì„œ ê°’ì„ ë°›ì•„ì˜¤ëŠ” ê²ƒì´ë¼ ì•„ë‹ˆë¼, ë¹ˆ ê°ì²´ë¥¼ ë°›ì•„ì˜¤ëŠ” ê²ƒ ë˜ëŠ” íŒŒë¼ë¯¸í„° ìë¦¬ì—ì„œ ê°ì²´ë¥¼ ìƒì„±í–ˆë‹¤ê³  ë°›ì•„ë“¤ì´ë©´ ë” ìµìˆ™í•˜ê²Œ í™œìš©í•  ìˆ˜ ìˆì„ë“¯í•˜ë‹¤.