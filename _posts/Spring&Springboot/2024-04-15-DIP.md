---
layout: single
title: ìŠ¤í”„ë§ DI pattern ë‹¤ë£¨ê¸°
categories: ['Spring & Spring boot']
tag: [Backend, Java, ìë°”, ì„œë²„, ì„œë¸”ë¦¿, ìŠ¤í”„ë§]
toc: true
---


# ğŸ“–ìƒì„±ìê°€ ìˆëŠ” ê°ì²´ë¥¼ DI patternì„ í™œìš©í•˜ì—¬ ìƒì„±í•˜ê¸°

MessageBean ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•˜ëŠ” í´ë˜ìŠ¤ë¥¼ í•˜ë‚˜ ë§Œë“¤ê³ , DI íŒ¨í„´ìœ¼ë¡œ êµ¬í˜„ì„ í•˜ë ¤ê³  í•œë‹¤. ì´ë•Œ ìƒì„±ìê°€ ìˆëŠ” ê²½ìš°ì˜ ì˜ˆì œì´ë‹¤.

### MessageBean.java

```java
public interface MessageBean {
	public void sayHello();
}
```

### MessageBeanImpl.java

```java
public class MessageBeanImpl implements MessageBean{
	private String name;
	private int age;
	private String greeting;

	public MessageBeanImpl() {}
	
	public MessageBeanImpl(String name, int age, String greeting) {
		this.name = name;
		this.age = age;
		this.greeting = greeting;
	}

	@Override
	public void sayHello() {
		String msg = greeting + "!~~" + name + "ë‹˜, ë‹¹ì‹ ì˜ ë‚˜ì´ëŠ” " + age + "ì‚´ì…ë‹ˆë‹¤.";
		System.out.println(msg);
	}
}
```

### App.java

```java
public class App {
	private static ApplicationContext ctx;
	
    public static void main( String[] args ){
        ctx = new ClassPathXmlApplicationContext("config/basic05_config.xml");
    	
        MessageBean bean = ctx.getBean("bean", MessageBeanImpl.class);
        bean.sayHello();
        //ì•ˆë…•í•˜ì„¸ìš”!~~í™ê¸¸ë™ë‹˜, ë‹¹ì‹ ì˜ ë‚˜ì´ëŠ” 20ì‚´ì…ë‹ˆë‹¤. or
        //ì•ˆë…•í•˜ì„¸ìš”!~~ì„êº½ì •ë‹˜, ë‹¹ì‹ ì˜ ë‚˜ì´ëŠ” 30ì‚´ì…ë‹ˆë‹¤.
    }
}
```

App.javaì™€ ê°™ì´ ì™¸ë¶€ì—ì„œ ì˜ì¡´ì„±ì„ ì£¼ì… ë°›ì•„ ìµœì¢…ì ìœ¼ë¡œ ë™ì‘í•˜ëŠ” í´ë˜ìŠ¤ë¥¼ consumer í´ë˜ìŠ¤ë¼ê³  í•œë‹¤.

ì—¬ê¸°ê¹Œì§€ê°€ ì˜ˆì œë¥¼ ìœ„í•œ ì½”ë“œë“¤ì´ê³ , ì˜ì¡´ì„±ì„ ì£¼ì…í•˜ê¸° ìœ„í•´ì„œ ë‘ ê°€ì§€ ë°©ë²•ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.

## ğŸ“Constructor-based DI

### basic05_config.xml

```xml
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.springframework.org/schema/beans
        https://www.springframework.org/schema/beans/spring-beans.xsd">
    
    <bean id="bean" class="basic05.MessageBeanImpl">
			<constructor-arg index="0" value="í™ê¸¸ë™" />
			<constructor-arg index="1" value="20" />
			<constructor-arg index="2" value="ì•ˆë…•í•˜ì„¸ìš”" />		
		</bean>
	
</beans>
```

`constructor-arg` íƒœê·¸ë¥¼ í™œìš©í•˜ì—¬ ìƒì„±ìì— ì¸ìë¥¼ ë„˜ê²¨ì¤„ ìˆ˜ ìˆë‹¤. ì´ë ‡ê²Œ ë©”ì¸ í•¨ìˆ˜ì—ì„œ ê°ì²´ë¥¼ ìƒì„±í•˜ì§€ ì•Šê³  ì™¸ë¶€ì—ì„œ ìƒì„±ìë¥¼ í˜¸ì¶œí•˜ì—¬ ê°ì²´ë¥¼ ìƒì„±í•˜ëŠ” ë°©ì‹ì´ Constructor-based DIì´ë‹¤.

ì¸ë±ìŠ¤ê°€ ì•„ë‹ˆë¼ íƒ€ì…ìœ¼ë¡œ ë§¤ì¹­í•´ì¤„ ìˆ˜ë„ ìˆë‹¤.

## ğŸ“Setter-based DI

```xml
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.springframework.org/schema/beans
        https://www.springframework.org/schema/beans/spring-beans.xsd">
    
    <bean id="bean" class="basic05.MessageBeanImpl">
			<constructor-arg index="0" value="í™ê¸¸ë™" />
			<constructor-arg index="1" value="20" />
			<constructor-arg index="2" value="ì•ˆë…•í•˜ì„¸ìš”" />	
			<!-- ì¶”ê°€ëœ ì½”ë“œ -->
			<property name="name" value="ì„êº½ì •" />
			<property name="age" value="30" />	
		</bean>
	
</beans>
```

`property` íƒœê·¸ë¥¼ í™œìš©í•˜ì—¬ setter ë©”ì„œë“œë¥¼ í˜¸ì¶œí•  ìˆ˜ ìˆë‹¤. setter ë©”ì„œë“œëŠ” ê·œì•½ì— ë”°ë¼ set+â€í”„ë¡œí¼í‹°ì´ë¦„(ì²«ê¸€ì ëŒ€ë¬¸ì)â€ë¡œ ì´ë¦„ì´ ì •í•´ì ¸ ìˆëŠ”ë°, `name` ì†ì„±ì— í”„ë¡œí¼í‹° ì´ë¦„ë§Œ ë„£ì–´ì£¼ë©´ ì•Œì•„ì„œ í˜¸ì¶œì„ í•´ì¤€ë‹¤.

# ğŸ“– ref ì†ì„±ìœ¼ë¡œ í´ë˜ìŠ¤ ê°„ DI íŒ¨í„´ ì ìš©í•˜ê¸°

ì´ë²ˆì—ëŠ” ìœ„ì˜ ì½”ë“œì— ì¸ì‚¬ë§ì„ ë‹¤ì–‘í•œ ë°©ë²•ìœ¼ë¡œ ì¶œë ¥í•  ìˆ˜ ìˆê²Œ í•˜ëŠ” ì½”ë“œë¥¼ ì¶”ê°€í•˜ê³ ì í•œë‹¤.

### Outputter.java

```java
public interface Outputter {
	void output(String msg) throws Exception;
}
```

### FileOutputter.java

```java
import java.io.FileWriter;

public class FileOutputter implements Outputter{
	private String filePath;
	
	public void setFilePath(String path) {
		filePath = path;
	}
	
	@Override
	public void output(String msg) throws Exception {
		FileWriter writer = new FileWriter(filePath);
		writer.write(msg);
		writer.close();
	}
}

```

íŒŒì¼ ì…ì¶œë ¥ì„ í•˜ëŠ” í´ë˜ìŠ¤ë¥¼ ìƒì„±í•´ Outputter ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•œë‹¤.

### MessageBeanImpl.java

ì¸ì‚¬ë§ì„ íŒŒì¼ë¡œ ì¶œë ¥í•˜ê¸° ìœ„í•´ì„œ ì˜¤ë²„ë¼ì´ë”©í•œ sayHello() ë©”ì„œë“œ ë‚´ì—ì„œ FileOutputter ê°ì²´ë¥¼ ê°€ì ¸ì˜¤ë ¤ê³  í•˜ëŠ”ë°, consumer í´ë˜ìŠ¤ê°€ ì•„ë‹Œ ê³³ì—ì„œ getBean()í•¨ìˆ˜ë¡œ ê°ì²´ë¥¼ ê°€ì ¸ì˜¤ëŠ” ê²ƒì€ ì ì ˆí•´ë³´ì´ì§€ ì•ŠëŠ”ë‹¤. ë”°ë¼ì„œ Outputter í”„ë¡œí¼í‹°ë¥¼ ì¶”ê°€í•˜ê³ , setter-based DI patternì„ ì ìš©í•´ë³´ê³ ì í•œë‹¤.

```java
public class MessageBeanImpl implements MessageBean{
	private String name;
	private int age;
	private String greeting;
	private Outputter outputter;

	public MessageBeanImpl() {}
	
	public MessageBeanImpl(String name, int age, String greeting) {
		this.name = name;
		this.age = age;
		this.greeting = greeting;
	}
	
	public void setName(String name) {
		this.name = name;
	}

	public void setAge(int age) {
		this.age = age;
	}

	public void setGreeting(String greeting) {
		this.greeting = greeting;
	}
	
	public void setOutputter(FileOutputter outputter) {
		this.outputter = outputter;
	}

	@Override
	public void sayHello() {
		String msg = greeting + "!~~" + name + "ë‹˜, ë‹¹ì‹ ì˜ ë‚˜ì´ëŠ” " + age + "ì‚´ì…ë‹ˆë‹¤.";
		System.out.println(msg);
		
		try {
			outputter.output(msg);
		}
		catch(Exception e) {
			e.printStackTrace();
		}
	}

}
```

### basic05_config.xml

```xml
<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://www.springframework.org/schema/beans
        https://www.springframework.org/schema/beans/spring-beans.xsd">
    
     <bean id="bean" class="basic05.MessageBeanImpl">
				<constructor-arg index="0" value="í™ê¸¸ë™" />
				<constructor-arg index="1" value="20" />
				<constructor-arg index="2" value="ì•ˆë…•í•˜ì„¸ìš”" />		

				<property name="outputter" ref="writer" />
			</bean>
				
			<bean id="writer" class="basic05.FileOutputter">
				<property name="filePath" value="src/main/java/basic05/result.txt" />
			</bean>
	
</beans>
```

ì •í•´ì§„ ê°’ì„ ê°€ì ¸ì˜¤ëŠ” ê²Œ ì•„ë‹ˆë¼, ì–´ë–¤ ê°’ì˜ ì£¼ì†Œë¥¼ ë°›ì•„ì™€ì•¼ í•˜ëŠ” ê²½ìš° value ëŒ€ì‹  ref ì†ì„±ì„ í™œìš©í•  ìˆ˜ ìˆë‹¤.